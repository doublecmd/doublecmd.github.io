<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>DC - Lua Scripting</title>
    <link rel="stylesheet" type="text/css" href="doublecmd.css">
    <link rel="shortcut icon" href="../../pixmaps/common/favicon.ico">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>

  <body>
    <a name="topofpage"></a>
    <div class="header"><a href="index.html"><img src="../../pixmaps/common/dclogo2017.png" alt="Double Commander" height="48" width="374"></a>
      <div id="global-nav" class="nav"><a title="Double Commander Home Page" href="https://doublecmd.sourceforge.io/" target="_blank">Homepage</a> | <a title="Double Commander Wiki" href="https://github.com/doublecmd/doublecmd/wiki" target="_blank">Wiki</a></div>
    </div>
    <div class="footer"><div class="nav"><a title="Index" href="index.html">Index</a> | <a title="Previous page" href="regexp.html">Previous</a> | <a title="Next page" href="commandline.html">Next</a></div></div>

    <div class="dchelpage">
      <div>
        <h1>2.15. Lua Scripting</h1>
      </div>

      <div>
        <h2>Content</h2>
        <dl>
          <dt>1. <a href="#preface">Introduction</a></dt>
          <dt>2. <a href="#dllrequired">DLL required</a></dt>
          <dt>3. <a href="#libraries">Double Commander functions libraries</a></dt>
          <dd>
            <dl>
              <dt>3.1. <a href="#libdc">DC libraries</a></dt>
              <dd>
                <dl>
                  <dt>3.1.1. <a href="#exampleex">Example with the DC.ExecuteCommand</a></dt>
                </dl>
              </dd>
              <dt>3.2. <a href="#librarysystem">System library</a></dt>
              <dd>
                <dl>
                  <dt>3.2.1. <a href="#detailattr">Details on SysUtils.FileGetAttr returned value</a></dt>
                  <dt>3.2.2. <a href="#exampleattr">Example with SysUtils.FileGetAttr</a></dt>
                  <dt>3.2.3. <a href="#examplefind">Example using FindFirst, FindNext and FindClose</a></dt>
                </dl>
              </dd>
              <dt>3.3. <a href="#libraryclip">Clipboard library</a></dt>
              <dd>
                <dl>
                  <dt>3.3.1. <a href="#exampleclip">Example of usage clipboard library</a></dt>
                </dl>
              </dd>
              <dt>3.4. <a href="#librarydialogs">Dialogs library</a></dt>
              <dd>
                <dl>
                  <dt>3.4.1. <a href="#dlgbuts">Buttons displayed in Dialogs.MessageBox</a></dt>
                  <dt>3.4.2. <a href="#dlgstyle">Style of box of Dialogs.MessageBox</a></dt>
                  <dt>3.4.3. <a href="#dlgdefbut">Default active button of Dialogs.MessageBox</a></dt>
                  <dt>3.4.4. <a href="#msgreturn">Returned value of Dialogs.MessageBox</a></dt>
                  <dt>3.4.5. <a href="#mesgboxsample">Example of usage of the Dialogs.MessageBox</a></dt>
                  <dt>3.4.6. <a href="#querysample">Example of usage of the Dialogs.InputQuery</a></dt>
                </dl>
              </dd>
              <dt>3.5. <a href="#libraryutf8">UTF-8 library</a></dt>
              <dt>3.6. <a href="#libraryos">OS library</a></dt>
            </dl>
          </dd>
        </dl>
      </div>

      <div>
        <h2><a name="preface">1. Introduction</a></h2>
        <p>Double Commander can execute Lua scripts via <a href="cmds.html#cm_ExecuteScript">cm_ExecuteScript</a> command.</p>
        <p>It is also possible to write content plugins using Lua script, examples can be found in the program folder (<tt>plugins/wdx/scripts</tt>).
          The Wiki has a <a href="https://github.com/doublecmd/doublecmd/wiki/Plugins-development" target="_blank">page</a> dedicated to writing plugins.
          Limitations: only the following data types are supported</p>
        <ul>
          <li><i>ft_numeric_32</i>&nbsp;&ndash; a 32-bit signed number;</li>
          <li><i>ft_numeric_64</i>&nbsp;&ndash; a 64-bit signed number;</li>
          <li><i>ft_numeric_floating</i>&nbsp;&ndash; a floating point number;</li>
          <li><i>ft_boolean</i>&nbsp;&ndash; boolean type: <i>true</i> or <i>false</i>;</li>
          <li><i>ft_multiplechoice</i>&nbsp;&ndash; a value allowing a limited number of choices;</li>
          <li><i>ft_string</i>&nbsp;&ndash; a text string (use UTF-8);</li>
          <li><i>ft_fulltext</i>&nbsp;&ndash; a full text (multiple text strings), used only for searching with plugins;</li>
          <li><i>ft_datetime</i>&nbsp;&ndash; for date/time: a returned date will be converted to a formatted date and time string (value depends on your regional settings).</li>
        </ul>
        <p>Note: When saving scripts, use UTF-8 encoding without BOM.</p>
        <p>More informations on Lua script programming language are available on the web on <a href="https://www.lua.org/" target="_blank">this link</a>.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="dllrequired">2. DLL required</a></h2>
        <p>In order to interpret Lua script file, we need to have a Lua DLL file (Double Commander supports versions 5.1 - 5.4) in the same folder as the executable of Double Commander or in system folder.</p>
        <p>By default DC looks for a file with name <tt>lua5.1.dll</tt> (Windows), <tt>liblua5.1.so.0</tt> (Unix or GNU/Linux) or <tt>liblua5.1.dylib</tt> (macOS<sup>(<a title="Note about macOS support" href="https://github.com/doublecmd/doublecmd/wiki/Supported-platforms#Mac_OS_X" target="_blank">*</a>)</sup>). We can change the file name in the <a href="configuration.html#luapathtolibrary">Lua library file to use</a> parameter manually.</p>
        <p>We can use DLL file from <a href="https://luajit.org/" target="_blank">LuaJIT project</a>.
           LuaJIT combines a high-speed interpreter, written in assembler, with a state-of-the-art JIT compiler. Also we get FFI library, which allows calling external C functions and using C data structures from pure Lua code.</p>
        <p>DC distributives for Windows have Lua DLL by default (in DC 0.9.7 and newer from LuaJIT project), in other cases we may find and install it through our packages manager or compile it. If we're using a 64-bits version of DC, the DLL must be the 64-bits version as well.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="libraries">3. Double Commander functions libraries</a></h2>
        <p>Double Commander offer a few libraries of functions for our Lua scripts.</p>
        <p>Here is the list of them.</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="3">List of libraries</th></tr>
          <tr class="rowsubtitle"><th class="namecolumn">Library name</th><th class="namecolumn">Script name</th><th class="categorydesccolumn">Quick description</th></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#libdc">Double Commander library</a></div></td><td class="hintcell">DC</td><td class="hintcell">Double Commander specific functions</td></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#librarysystem">System library</a></div></td><td class="hintcell">SysUtils</td><td class="hintcell">Various system functions</td></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#libraryclip">Clipboard library</a></div></td><td class="hintcell">Clipbrd</td><td class="hintcell">Provides external clipboard functionality</td></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#librarydialogs">Dialogs library</a></div></td><td class="hintcell">Dialogs</td><td class="hintcell">Interacts with user</td></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#libraryutf8">UTF-8 library</a></div></td><td class="hintcell">LazUtf8</td><td class="hintcell">UTF-8 string functions</td></tr>
          <tr><td class="varcell"><div class="firstcolumnaleft"><a href="#libraryos">OS library</a></div></td><td class="hintcell">OS</td><td class="hintcell">Functions related with the operating system</td></tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="libdc">3.1. DC library</a></h2>
        <p>This library contains Double Commander specific functions.</p>
        <p>It provides all its functions inside the table <code>DC</code>.</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">DC library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">DC.LogWrite</div></td>
            <td class="hintcell">
              <p class="definition">DC.LogWrite(Message, MsgType, bForce, bLogFile)</p>
              <p>Write a message to the log window.</p>
              <p>Here is the description of each field:</p>
              <ul>
                <li><var>Message</var> : The message text.</li>
                <li><var>MsgType</var> : The message type: 0 - information, 1 - success, 2 - error.</li>
                <li><var>bForce</var> : A boolean, when true, will show the log window if invisible.</li>
                <li><var>bLogFile</var> : A boolean, when true, will write the message also in the log file.</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">DC.CurrentPanel</div></td>
            <td class="hintcell">
              <p class="definition">iPanel = DC.CurrentPanel()</p>
              <p>Get active panel: returns 0 if left panel is active or 1 if right.</p>
              <p class="definition">DC.CurrentPanel(iPanel)</p>
              <p>Set active panel: left panel if <var>iPanel</var> equal 0 or right if 1.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">DC.ExecuteCommand</div></td>
            <td class="hintcell">
              <p class="definition">DC.ExecuteCommand(Command, Param1, Param2,...,ParamX)</p>
              <p>This allows the script to invoke internal commands of DC.</p>
              <p>The <var>Command</var> is holding the actual internal command name.</p>
              <p>We may provide as many <var>Param...</var> as command may support.</p>
            </td>
          </tr>
        </table>
        <p><b>Note</b>: Scripts work in the main thread of Double Commander, so sometimes sequential execution of <a href="cmds.html#catnavigation">commands for navigation</a> may not work (for example, large directories, slow disk), in this case try to disable <i>Load file list in separate thread</i> in the <a href="configuration.html#ConfigViewEx">settings</a>.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="exampleex">3.1.1. Example with the DC.ExecuteCommand</a></h2>
        <p>In this example, we wrote a simple script that will do the following:</p>
        <ol>
          <li>focus to right panel</li>
          <li>close all opened tabs</li>
          <li>switch to a specific folder</li>
          <li>focus the left panel</li>
          <li>close all opened tabs</li>
          <li>switch to a specific folder</li>
          <li>open a new tab</li>
          <li>switch to a specific folder</li>
        </ol>

        <pre>
<span class="luacmt">-- 1. Focus on right panel.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_FocusSwap"</span>, <span class="luastr">"side=right"</span><span class="luasbl">)</span>

<span class="luacmt">-- 2. Close all tabs.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_CloseAllTabs"</span><span class="luasbl">)</span>

<span class="luacmt">-- 3. Switch to a specific directory.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_ChangeDir"</span>, <span class="luastr">"E:\\FakeKey\\Documents\\Music"</span><span class="luasbl">)</span>

<span class="luacmt">-- 4. Focus on left panel.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_FocusSwap"</span>, <span class="luastr">"side=left"</span><span class="luasbl">)</span>

<span class="luacmt">-- 5. Close all tabs.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_CloseAllTabs"</span><span class="luasbl">)</span>

<span class="luacmt">-- 6. Switch to a specific directory.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_ChangeDir"</span>, <span class="luastr">"C:\\Users\\Public\\Music"</span><span class="luasbl">)</span>

<span class="luacmt">-- 7. Open a new tab.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_NewTab"</span><span class="luasbl">)</span>

<span class="luacmt">-- 8. Switch to a specific directory.</span>
<span class="mark">DC.ExecuteCommand</span><span class="luasbl">(</span><span class="luastr">"cm_ChangeDir"</span>, <span class="luastr">"E:\\VirtualMachines\\ShareFolder"</span><span class="luasbl">)</span></pre>

        <p>Using the internal command <a href="cmds.html#cm_ExecuteScript">cm_ExecuteScript</a>, we may configure a tool bar button that will execute our script.</p>
        <p>Assuming this script file is <code>E:\scripts\lua\music.lua</code>, we could have the button configured this way:</p>
        <p class="figure"><img class="largeimage" title="Invoking a lua script from toolbar" alt="Invoking a lua script from toolbar" src="images/imgDC/luaimg1.png" width="560" height="290"></p>

        <p>Also, we may use the internal Double Commander Editor for editing our scripts.</p>
        <p>If filename has <code>.lua</code> file extension, it will be recognized by internal editor and it will provide us syntax highlighting specific for this Lua language:</p>
        <p class="figure"><img class="largeimage" title="Lua syntax highlighting with internal editor" alt="Lua syntax highlighting with internal editor" src="images/imgDC/luaimg2.png" width="660" height="480"></p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="librarysystem">3.2. System library</a></h2>
        <p>This library contains various system functions.</p>
        <p>It provides all its functions inside the table <code>SysUtils</code>.</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">System library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.Sleep</div></td>
            <td class="hintcell">
              <p class="definition">SysUtils.Sleep(Milliseconds)</p>
              <p>Suspends the execution of the script for the specified number of <var>Milliseconds</var>.<br>After the specified period has expired, script execution resumes.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.GetTickCount</div></td>
            <td class="hintcell">
              <p class="definition">SysUtils.GetTickCount()</p>
              <p>Returns an increasing clock tick count. It is useful for time measurements, but no assumptions should be made as to the interval between the ticks.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.FileExists</div></td>
            <td class="hintcell">
              <p class="definition">bFlagExists = SysUtils.FileExists(FileName)</p>
              <p>Check whether a particular file exists in the filesystem.</p>
              <p>Returns in <var>bFlagExists</var> the value <code>true</code> if file with name <var>FileName</var> exists on the disk, or <code>false</code> otherwise.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.DirectoryExists</div></td>
            <td class="hintcell">
              <p class="definition">bFlagExists = SysUtils.DirectoryExists(Directory)</p>
              <p>Checks whether <var>Directory</var> exists in the filesystem and is actually a directory.</p>
              <p>If this is the case, the function returns in <var>bFlagExists</var> the value <code>true</code> otherwise <code>false</code> is returned.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.FileGetAttr</div></td>
            <td class="hintcell">
              <p class="definition">Attr = SysUtils.FileGetAttr(FileName)</p>
              <p>Returns in <var>Attr</var> the attribute settings of file <var>FileName</var>.</p>
              <p>See the detail explanations of the returned value <a href="#detailattr">here</a>.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.FindFirst</div></td>
            <td class="hintcell">
              <p class="definition">Handle, FindData = SysUtils.FindFirst(Path)</p>
              <p>Looks for files that match the <var>Path</var>, generally with wildcards.</p>
              <p>If no file is found, <var>Handle</var> will be <code>nil</code>.</p>
              <p>When at least one item is found, the returned <var>Handle</var> may be used in subsequent <code>SysUtils.FindNext</code> to find other occurences of the same pattern.</p>
              <p>The <var>FindData</var> table contains information about the file or directory found.</p>
              <p>The field of the <var>FindData</var> table are:</p>
              <ul>
                <li><var>Name</var> : The file name (without path).</li>
                <li><var>Attr</var> : The file attributes of the file (see details <a href="#detailattr">here</a>).</li>
                <li><var>Size</var> : The size of the file in bytes.</li>
                <li><var>Time</var> : The time stamp of the file (seconds since Jan 01 1970)</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.FindNext</div></td>
            <td class="hintcell">
              <p class="definition">Result, FindData = SysUtils.FindNext(Handle)</p>
              <p>Finds the next occurrence of a search sequence initiated by <var>FindFirst</var> by re-using the <var>Handle</var> returned previously.</p>
              <p>Returned <var>Result</var> will be non-nil if a file or directory is found and will be <code>nil</code> otherwise.</p>
              <p>The same notes mentioned for <code>SysUtils.FindFirst</code> applied here.</p>
              <p><b><span class="uline">Remark:</span> The last <code>SysUtils.FindNext</code> call must always be followed by a <code>SysUtils.FindClose</code> call with the same <var>Handle</var>. Failure to do so will result in memory leaks.</b></p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.FindClose</div></td>
            <td class="hintcell">
              <p class="definition">SysUtils.FindClose(Handle)</p>
              <p>Ends a series of <code>SysUtils.FindFirst</code>/<code>SysUtils.FindNext</code> calls.</p>
              <p>Frees any memory used by these calls.</p>
              <p>It is <em>absolutely</em> necessary to do this call, or memory losses may occur.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.CreateDirectory</div></td>
            <td class="hintcell">
              <p class="definition">bResult = SysUtils.CreateDirectory(Directory)</p>
              <p>Create a chain of directories, <var>Directory</var> is the full path to directory.</p>
              <p>Returns <code>true</code> if <var>Directory</var> already exist or was created successfully. If it failed to create any of the parts, <code>false</code> is returned.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.CreateHardLink</div></td>
            <td class="hintcell">
              <p class="definition">bResult = SysUtils.CreateHardLink(Path, LinkName)</p>
              <p>Create the hard link <var>LinkName</var> to file <var>Path</var>.</p>
              <p>Returns <code>true</code> if successful, <code>false</code> otherwise.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.CreateSymbolicLink</div></td>
            <td class="hintcell">
              <p class="definition">bResult = SysUtils.CreateSymbolicLink(Path, LinkName)</p>
              <p>Create the symbolic link <var>LinkName</var> to file or directory <var>Path</var>.</p>
              <p>Returns <code>true</code> if successful, <code>false</code> otherwise.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ReadSymbolicLink</div></td>
            <td class="hintcell">
              <p class="definition">sTarget = SysUtils.ReadSymbolicLink(LinkName, Recursive)</p>
              <p>Read destination of the symbolic link <var>LinkName</var>.</p>
              <p>If <var>Recursive</var> is <code>true</code> and the link points to a link then it's resolved recursively until a valid file name that is not a link is found.</p>
              <p>Returns the path where the symbolic link <var>LinkName</var> is pointing to or an empty string when the link is invalid or the file it points to does not exist and <var>Recursive</var> is <code>true</code>.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ExtractFileName</div></td>
            <td class="hintcell">
              <p class="definition">sName = SysUtils.ExtractFileName(FileName)</p>
              <p>Extract the filename part from a full path filename.</p>
              <p>The filename consists of all characters after the last directory separator character ("/" or "\") or drive letter.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ExtractFilePath</div></td>
            <td class="hintcell">
              <p class="definition">sPath = SysUtils.ExtractFilePath(FileName)</p>
              <p>Extract the path from a filename (including drive letter).</p>
              <p>The path consists of all characters before the last directory separator character ("/" or "\"), including the directory separator itself.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ExtractFileDir</div></td>
            <td class="hintcell">
              <p class="definition">sDir = SysUtils.ExtractFileDir(FileName)</p>
              <p>Extract only the directory part of <var>FileName</var>, including a drive letter.</p>
              <p>The directory name has NO ending directory separator, in difference with <code>SysUtils.ExtractFilePath</code>.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ExtractFileDrive</div></td>
            <td class="hintcell">
              <p class="definition">sDrive = SysUtils.ExtractFileDrive(FileName)</p>
              <p>Extract the drive part from a filename.</p>
              <p>Note that some operating systems do not support drive letters.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.ExtractFileExt</div></td>
            <td class="hintcell">
              <p class="definition">sExt = SysUtils.ExtractFileExt(FileName)</p>
              <p>Return the extension from a filename (all characters after the last "." (dot), including the "." character).</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.GetAbsolutePath</div></td>
            <td class="hintcell">
              <p class="definition">sName = SysUtils.GetAbsolutePath(FileName, BaseDirectory)</p>
              <p>Returns the absolute (full) path to the file:</p>
              <ul>
                <li><var>FileName</var> : The filename with a relative path.</li>
                <li><var>BaseDirectory</var> : The directory that was used as the base directory for <var>FileName</var>.</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.GetRelativePath</div></td>
            <td class="hintcell">
              <p class="definition">sName = SysUtils.GetRelativePath(FileName, BaseDirectory)</p>
              <p>Returns the filename relative to the specified directory:</p>
               <ul>
                <li><var>FileName</var> : The full (absolute) filename.</li>
                <li><var>BaseDirectory</var> : The directory that will be used as the base directory <var>FileName</var>.</li>
              </ul>
              <p>If <var>FileName</var> and <var>BaseDirectory</var> contain the same value, the function will return an empty string ("").</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.MatchesMask</div></td>
            <td class="hintcell">
              <p class="definition">bResult = SysUtils.MatchesMask(FileName, Mask, MaskOptions)</p>
              <p>Returns <code>true</code> if <var>FileName</var> matches the passed mask <var>Mask</var>.</p>
              <p><var>MaskOptions</var> (optional parameter, 0 by default) is set as the sum of the following values:</p>
              <table class="innercmddesc">
                <tr class="rowinnerdesc">
                  <th class="innerdescheader">Value</th>
                  <th class="innerdescheader">Description</th>
                </tr>
                <tr>
                  <td class="varcell"><div class="firstcolumnaleft">1</div></td>
                  <td class="hintcell">case sensitive</td>
                </tr>
                <tr>
                  <td class="varcell"><div class="firstcolumnaleft">2</div></td>
                  <td class="hintcell">ignore accents and ligatures</td>
                </tr>
                <tr>
                  <td class="varcell"><div class="firstcolumnaleft">4</div></td>
                  <td class="hintcell">Windows style filter: "*.*" also match files without extension, etc.</td>
                </tr>
                <tr>
                  <td class="varcell"><div class="firstcolumnaleft">8</div></td>
                  <td class="hintcell">enable pinyin support (file <tt>pinyin.tbl</tt> will be used)</td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.MatchesMaskList</div></td>
            <td class="hintcell">
              <p class="definition">bResult = SysUtils.MatchesMaskList(FileName, MaskList, Separator, MaskOptions)</p>
              <p>Returns <code>true</code> if <var>FileName</var> matches at least one of passed masks <var>MaskList</var> separated by <var>Separator</var> (";" by default).</p>
              <p><var>Separator</var> and <var>MaskOptions</var> (see above) are optional parameters.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">SysUtils.PathDelim</div></td>
            <td class="hintcell">
              <p class="definition">SysUtils.PathDelim</p>
              <p>The character used by the current operating system to separate directory names in the full file name.</p>
              <p>In Unix/Linux system the directory separator will be "/" and in Windows it will be "\".</p>
            </td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="detailattr">3.2.1. Details on SysUtils.FileGetAttr returned value</a></h2>
        <p><code>FileGetAttr</code> returns the attribute settings of file <var>FileName</var>.</p>
        <p>The attribute is a <var>OR</var>-ed combination of the following constants:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Constants uses in SysUtils.FileGetAttr returned value</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Value</th><th class="categorydesccolumn">Signification</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000001<br><small class="firstcolumnaleft">faReadOnly</small></div></td>
            <td class="hintcell">The file is read-only.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000002<br><small class="firstcolumnaleft">faHidden</small></div></td>
            <td class="hintcell">The file is hidden.<br>In Unix/Linux, this means that the filename starts with a dot.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000004<br><small class="firstcolumnaleft">faSysFile</small></div></td>
            <td class="hintcell">The file is a system file.<br>In Unix/Linux, this means that the file is a character, block or FIFO file.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000008<br><small class="firstcolumnaleft">faVolumeId</small></div></td>
            <td class="hintcell">Volume Label.<br>Only for DOS/Windows on a plain FAT (not VFAT or Fat32) filesystem.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000010<br><small class="firstcolumnaleft">faDirectory</small></div></td>
            <td class="hintcell">File is a directory.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000020<br><small class="firstcolumnaleft">faArchive</small></div></td>
            <td class="hintcell">File is archived.<br>Not possible in Unix/Linux.</td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">0x00000400<br><small class="firstcolumnaleft">faSymLink</small></div></td>
            <td class="hintcell">File is a symbolic link.</td>
          </tr>
          <tr>
            <td colspan="2"><b>Note: In case of an error, -1 is returned.</b>
          </tr>
        </table>
        <p>See an example in the <a href="#exampleattr">next section</a>.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="exampleattr">3.2.2. Example with SysUtils.FileGetAttr</a></h2>
        <p>This following script is an example of usage of the <code>SysUtils.FileGetAttr</code>.</p>
        <p>When the parameter is detected to be a directory, it will open a new tab in the active panel and switch to it.</p>
        <pre>
<span class="luakyw">local</span> params <span class="luasbl">=</span> <span class="luasbl">{...}</span>
<span class="luakyw">local</span> myfileattr

<span class="luakyw">if</span> <span class="luasbl">#</span>params <span class="luasbl">==</span> <span class="luanum">1</span> <span class="luakyw">then</span> <span class="luacmt">-- We got at least one parameter?</span>
  myfileattr <span class="luasbl">=</span> <span class="mark">SysUtils.FileGetAttr</span><span class="luasbl">(</span>params<span class="luasbl">[</span><span class="luanum">1</span><span class="luasbl">])</span>
  <span class="luakyw">if</span> myfileattr <span class="luasbl">&gt;</span> <span class="luanum">0</span> <span class="luakyw">then</span> <span class="luacmt">-- We got a valid attribute?</span>
    <span class="luakyw">if</span> math<span class="luasbl">.</span><span class="luafct">floor</span><span class="luasbl">(</span>myfileattr <span class="luasbl">/</span> <span class="luanum">0x00000010</span><span class="luasbl">)</span> <span class="luasbl">%</span> <span class="luanum">2</span> <span class="luasbl">~=</span> <span class="luanum">0</span> <span class="luakyw">then</span>
      <span class="luacmt">-- bit 4 is set? So it's a directory.</span>
      DC.ExecuteCommand<span class="luasbl">(</span><span class="luastr">"cm_NewTab"</span><span class="luasbl">)</span>
      DC.ExecuteCommand<span class="luasbl">(</span><span class="luastr">"cm_ChangeDir"</span><span class="luasbl">,</span> params<span class="luasbl">[</span><span class="luanum">1</span><span class="luasbl">])</span>
    <span class="luakyw">end</span>
  <span class="luakyw">end</span>
<span class="luakyw">end</span></pre>

        <p>In the above example, the <var>params[1]</var> is the 1st parameter passed to the script.</p>
        <p>When using the internal command <a href="cmds.html#cm_ExecuteScript">cm_ExecuteScript</a>, it will will be the first parameter passed after the script filename.</p>
        <p>So in our example, we may program a sample toolbar button like the following:</p>
        <p class="figure"><img class="largeimage" title="Parameter with cm_ExecuteScript" alt="Parameter with cm_ExecuteScript" src="images/imgDC/luaimg3.png" width="560" height="290"></p>
        <p>In this example, the parameter <var>%"0%p</var> will be passed to the script. This will represent, unquoted, the filename of the item currently selected in the active panel at the moment we press the toolbar button.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="examplefind">3.2.3. Example using FindFirst, FindNext and FindClose</a></h2>
        <p>In the following script example, we'll scan the content of the directory we received in parameter and store resulting data into a text file with the filename passed as a second parameter.</p>
        <p>This will give us a good idea of the usage of <code>FindFirst</code>, <code>FindNext</code> and <code>FindClose</code>.</p>

        <pre>
<span class="luakyw">local</span> params <span class="luasbl">=</span> <span class="luasbl">{...}</span>

<span class="luakyw">if</span> <span class="luasbl">#</span>params <span class="luasbl">==</span> <span class="luanum">2</span> then <span class="luacmt">-- We got our 2 parameters?</span>
  <span class="luakyw">local</span> Result <span class="luasbl">=</span> <span class="luakyw">nil</span>
  <span class="luakyw">local</span> OutputFile <span class="luasbl">=</span> <span class="luakyw">nil</span>

  OutputFile <span class="luasbl">=</span> io<span class="luasbl">.</span>output<span class="luasbl">(</span>params<span class="luasbl">[</span><span class="luanum">2</span><span class="luasbl">])</span>

  <span class="luakyw">local</span> Handle<span class="luasbl">,</span>FindData <span class="luasbl">=</span> <span class="mark">SysUtils.FindFirst</span><span class="luasbl">(</span>params<span class="luasbl">[</span><span class="luanum">1</span><span class="luasbl">]</span> <span class="luasbl">..</span> <span class="luastr">"\\*"</span><span class="luasbl">)</span>
  <span class="luakyw">if</span> Handle <span class="luasbl">~=</span> <span class="luakyw">nil</span> <span class="luakyw">then</span>
    <span class="luakyw">repeat</span>
      io.<span class="luafct">write</span><span class="luasbl">(</span>FindData.Name <span class="luasbl">..</span> <span class="luastr">"\r"</span><span class="luasbl">)</span>
      io.<span class="luafct">write</span><span class="luasbl">(</span>FindData.Size <span class="luasbl">..</span> <span class="luastr">"\r"</span><span class="luasbl">)</span>
      io.<span class="luafct">write</span><span class="luasbl">(</span><span class="luastr">"---------------\r"</span><span class="luasbl">)</span>

      Result<span class="luasbl">,</span>FindData <span class="luasbl">=</span> <span class="mark">SysUtils.FindNext</span><span class="luasbl">(</span>Handle<span class="luasbl">)</span>
    <span class="luakyw">until</span> Result <span class="luasbl">==</span> <span class="luakyw">nil</span>

    <span class="mark">SysUtils.FindClose</span><span class="luasbl">(</span>Handle<span class="luasbl">)</span>
    io<span class="luasbl">.</span>close<span class="luasbl">(</span>OutputFile<span class="luasbl">)</span>
  <span class="luakyw">end</span>
<span class="luakyw">end</span></pre>
        <p>In the above example, we need to pass two parameters to our script:</p>
        <ol>
          <li><var>params[1]</var> - which is the directory we want the content</li>
          <li><var>params[2]</var> - which is the outputfilename to store the result</li>
        </ol>
        <p>So it's easy to configure a toolbar button using the internal command <a href="cmds.html#cm_ExecuteScript">cm_ExecuteScript</a> and pass the parameter to accomplish all this.</p>
        <p class="figure"><img class="largeimage" title="Parameter with cm_ExecuteScript" alt="Parameter with cm_ExecuteScript" src="images/imgDC/luaimg4.png" width="560" height="262"></p>
        <p>In this example, the parameter <var>%"0%Ds</var> will be passed to the script as the first parameter. This will represent, unquoted, the directory displayed by the active panel.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="libraryclip">3.3. Clipboard library</a></h2>
        <p>Double Commander may provide external clipboard functionality to our Lua scripts.</p>
        <p>Following table gives us the related functions:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Clipboard library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Clipbrd.Clear</div></td>
            <td class="hintcell">
              <p class="definition">Clipbrd.Clear()</p>
              <p>Clear the content of the clipboard.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Clipbrd.GetAsText</div></td>
            <td class="hintcell">
              <p class="definition">StringVar = Clipbrd.GetAsText()</p>
              <p>Get the current text content of the clipboard to assigned it to <var>StringVar</var>.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Clipbrd.SetAsText</div></td>
            <td class="hintcell">
              <p class="definition">Clipbrd.SetAsText(StringVar)</p>
              <p>Store in the clipboard the text content of <var>StringVar</var>.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Clipbrd.SetAsHtml</div></td>
            <td class="hintcell">
              <p class="definition">Clipbrd.SetAsHtml(Html)</p>
              <p>Adds html-formatted text <var>Html</var> to the clipboard (<code>CF_HTML</code> clipboard format).</p>
              <p>This contents will be inserted in applications which support this clipboard format, like MS Word, LO Writer, etc.</p>
              <p>It's correct to store data with both <code>Clipbrd.SetAsText</code> and <code>Clipbrd.SetAsHtml</code>. When we'll paste, the application will use the best one that it supports.</p>
              <p>For example we may have this:</p>
              <ul>
                <li><code>Clipbrd.SetAsText("Welcome to Double Commander!")</code></li>
                <li><code>Clipbrd.SetAsHtml("Welcome to &lt;B&gt;Double Commander&lt;/b&gt;!")</code></li>
              </ul>
              <p>If we switch to Notepad attempting to paste something, it will paste in plain text the message we copied with <code>Clipbrd.SetAsText</code>. But if we switch to Microsoft Word and paste something, it will paste the second one, the one with <b>Double Commander</b> in bold since the Microsoft Word recognize and support that clipboard content type.</p>
            </td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="exampleclip">3.3.1. Example of usage clipboard library</a></h2>
        <p>The following example is using three functions related with the clipboard: <code>Clear</code>, <code>GetAsText</code> and <code>SetAsText</code>.</p>
        <p>It's a relative long script but it's good to put together a few functions we've seen above.</p>
        <p>It assumes our active panel is currently into a directory with many source text files.</p>
        <p>It also assumes we currently have in clipboard a single word and that it will receive as a single parameter the current active folder.</p>
        <p>The script will scan the file in that current level of directory and will read the content of them one by one to detect text line that containts the word that was in clipboard.</p>
        <p>Then, the filenames of the files that contain at least one line with that word will be place into the clipboard.</p>
        <p>Then, the script will use the internal command <a href="cmds.html#cm_LoadSelectionFromClip">cm_LoadSelectionFromClip</a> and the files that have the words will then be selected.</p>
        <p>Also, at the end, we put back in our clipboard the original word that needed to be searched.</p>
        <pre>
<span class="luakyw">local</span> params <span class="luasbl">=</span> <span class="luasbl">{...}</span>
<span class="luakyw">local</span> Result <span class="luasbl">=</span> <span class="luakyw">nil</span>
<span class="luakyw">local</span> myfileattr
<span class="luakyw">local</span> bFound <span class="luasbl">=</span> false
<span class="luakyw">local</span> sCompleteFilename <span class="luasbl">=</span> <span class="luastr">""</span>
<span class="luakyw">local</span> InputFile <span class="luasbl">=</span> <span class="luakyw">nil</span>
<span class="luakyw">local</span> line <span class="luasbl">=</span> <span class="luastr">""</span>
<span class="luakyw">local</span> iPosS
<span class="luakyw">local</span> iPosE
<span class="luakyw">local</span> sFileToSelect <span class="luasbl">=</span> <span class="luastr">""</span>
<span class="luakyw">local</span> sSearchString <span class="luasbl">=</span> <span class="luastr">""</span>

<span class="luakyw">if</span> <span class="luasbl">#</span>params <span class="luasbl">==</span> <span class="luanum">1</span> <span class="luakyw">then</span> <span class="luacmt">-- We got our parameter?</span>
  sSearchString <span class="luasbl">=</span> <span class="mark">Clipbrd.GetAsText</span><span class="luasbl">()</span> <span class="luacmt">-- Get the expression to search.</span>
  <span class="mark">Clipbrd.Clear</span><span class="luasbl">()</span> <span class="luacmt">-- Making sure we have nothing in clipboard.</span>
  DC.ExecuteCommand<span class="luasbl">(</span><span class="luastr">"cm_MarkUnmarkAll"</span><span class="luasbl">)</span> <span class="luacmt">-- Make sure nothing is selected.</span>

  <span class="luacmt">-- Let's scan one by one all the files of our directory.</span>
  <span class="luakyw">local</span> Handle<span class="luasbl">,</span>FindData <span class="luasbl">=</span> SysUtils.FindFirst(params<span class="luasbl">[</span><span class="luanum">1</span><span class="luasbl">]</span> <span class="luasbl">..</span> <span class="luastr">"\\*"</span><span class="luasbl">)</span>
  <span class="luakyw">if</span> Handle <span class="luasbl">~=</span> <span class="luakyw">nil</span> <span class="luakyw">then</span>
    <span class="luakyw">repeat</span>
      sCompleteFilename <span class="luasbl">=</span> params<span class="luasbl">[</span><span class="luanum">1</span><span class="luasbl">]</span> <span class="luasbl">..</span> <span class="luastr">"\\"</span> <span class="luasbl">..</span> FindData<span class="luasbl">.</span>Name
      myfileattr <span class="luasbl">=</span> SysUtils.FileGetAttr<span class="luasbl">(</span>sCompleteFilename<span class="luasbl">)</span>
      <span class="luakyw">if</span> myfileattr <span class="luasbl">&gt;</span> <span class="luanum">0</span> <span class="luakyw">then</span> <span class="luacmt">-- We got a valid attribute?</span>
        <span class="luacmt">-- We need file, not directory!</span>
        <span class="luakyw">if</span> math<span class="luasbl">.</span><span class="luafct">floor</span><span class="luasbl">(</span>myfileattr <span class="luasbl">/</span> <span class="luanum">0x00000010</span><span class="luasbl">)</span> <span class="luasbl">%</span> <span class="luanum">2</span> <span class="luasbl">==</span> <span class="luanum">0</span> <span class="luakyw">then</span>

          <span class="luacmt">-- Let's now read the file line by line until the the end OR a found.</span>
          InputFile <span class="luasbl">=</span> io<span class="luasbl">.</span>open<span class="luasbl">(</span>sCompleteFilename<span class="luasbl">,</span> <span class="luastr">"r"</span><span class="luasbl">)</span>
          bFound <span class="luasbl">=</span> false

          <span class="luakyw">while</span> bFound <span class="luasbl">==</span> false <span class="luakyw">do</span>
            line <span class="luasbl">=</span> InputFile<span class="luasbl">:</span><span class="luafct">read</span><span class="luasbl">()</span>
            <span class="luakyw">if</span> line <span class="luasbl">==</span> <span class="luakyw">nil</span> <span class="luakyw">then</span> <span class="luakyw">break</span> <span class="luakyw">end</span>
            iPosS<span class="luasbl">,</span> iPosE <span class="luasbl">=</span> string<span class="luasbl">.</span>find<span class="luasbl">(</span>line, sSearchString<span class="luasbl">)</span>
            <span class="luakyw">if</span> iPosS <span class="luasbl">~=</span> <span class="luakyw">nil</span> <span class="luakyw">then</span> bFound <span class="luasbl">=</span> true <span class="luakyw">end</span>
          <span class="luakyw">end</span>

          <span class="luakyw">if</span> bFound <span class="luasbl">==</span> true <span class="luakyw">then</span>
            sFileToSelect <span class="luasbl">=</span> sFileToSelect <span class="luasbl">..</span> FindData<span class="luasbl">.</span>Name <span class="luasbl">..</span> <span class="luastr">"\n"</span>
          <span class="luakyw">end</span>

          io<span class="luasbl">.</span>close<span class="luasbl">(</span>InputFile<span class="luasbl">)</span>
        <span class="luakyw">end</span>
      <span class="luakyw">end</span>
      Result<span class="luasbl">,</span>FindData <span class="luasbl">=</span> SysUtils<span class="luasbl">.</span>FindNext<span class="luasbl">(</span>Handle<span class="luasbl">)</span>
    <span class="luakyw">until</span> Result <span class="luasbl">==</span> <span class="luakyw">nil</span>

    SysUtils<span class="luasbl">.</span>FindClose<span class="luasbl">(</span>Handle<span class="luasbl">)</span>
  <span class="luakyw">end</span>

  <span class="luacmt">-- If we've found something, select it!</span>
  <span class="luakyw">if</span> sFileToSelect <span class="luasbl">~=</span> <span class="luastr">""</span> <span class="luakyw">then</span>
    <span class="mark">Clipbrd.SetAsText</span><span class="luasbl">(</span>sFileToSelect<span class="luasbl">)</span>
    DC<span class="luasbl">.</span>ExecuteCommand<span class="luasbl">(</span><span class="luastr">"cm_LoadSelectionFromClip"</span><span class="luasbl">)</span>
  <span class="luakyw">end</span>

  <span class="mark">Clipbrd.SetAsText</span><span class="luasbl">(</span>sSearchString<span class="luasbl">)</span> <span class="luacmt">-- Restoring what we had in clipboard.</span>
<span class="luakyw">end</span></pre>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="librarydialogs">3.4. Dialogs library</a></h2>
        <p>This library allows our scripts to interact with user to display message, prompt for answers, etc.</p>
        <p>Following table gives us the related functions:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Dialogs library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Dialogs.MessageBox</div></td>
            <td class="hintcell">
              <p class="definition">ButPressed = Dialogs.MessageBox(Message, Title, ButFlags)</p>
              <p>Will diplay a message box prompting a user to click a button which will be returned by the function.</p>
              <p>Here is the description of each field:</p>
              <ul>
                <li><var>Message</var> : The message inside the box.</li>
                <li><var>Title</var> : The text displayed as the title of the box.</li>
                <li><var>ButFlags</var> : OR'ed value of constants to determine the buttons that will be displayed, the style of window and default button selected for the answer. See the following table the <a href="#dlgbuts">buttons displayed</a>, <a href="#dlgstyle">style of window</a> or <a href="#dlgdefbut">default button</a>.</li>
                <li><var>ButPressed</var> : Returned value indicating the button user pressed (see <a href="#msgreturn">this table</a>).</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Dialogs.InputQuery</div></td>
            <td class="hintcell">
              <p class="definition">bAck, sAnswer = Dialogs.InputQuery(Title, Msg, bMask, sDefault)</p>
              <p>Will display a requester box where user may enter a string value.</p>
              <p>Here is the description of each field:</p>
              <ul>
                <li><var>Title</var> : The text displayed as the title of the box.</li>
                <li><var>Msg</var> : The message inside the box.</li>
                <li><var>bMask</var> : A boolean, when true, will display "stars" to hide characters.</li>
                <li><var>sDefault</var> : The default suggested text that user may type over if necessary.</li>
                <li><var>bAck</var> : Returned boolean indicating if user effectively enter something or not.</li>
                <li><var>sAnswer</var> : Returned string when user entered something and then clicked ok.</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">Dialogs.InputListBox</div></td>
            <td class="hintcell">
              <p class="definition">sAnswer = Dialogs.InputListBox(Title, Msg, Items, sDefault)</p>
              <p>Displays a dialog box to allow the user to choose from a list of items.</p>
              <p>Here is the description of each field:</p>
              <ul>
                <li><var>Title</var> : The text displayed as the title of the dialog.</li>
                <li><var>Msg</var> : The message inside the dialog.</li>
                <li><var>Items</var> : A Lua table, each element of the table must be a string.</li>
                <li><var>sDefault</var> : The default selected item in the list.</li>
                <li><var>sAnswer</var> : Returned the selected item as a string or <code>nil</code> if the dialog is dismissed.</li>
              </ul>
            </td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="dlgbuts">3.4.1. Buttons displayed in Dialogs.MessageBox</a></h2>
        <p>The buttons displayed in the box displayed by <code>Dialogs.MessageBox</code> function are controlled by a OR'ed value with one of the following:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Constant of ButFlags regarding the buttons displayed of Dialogs.MessageBox</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Constant value</th><th class="categorydesccolumn">Buttons displayed, from left to right</th></tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0000<br><small class="firstcolumnaleft">MB_OK</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button OK" alt="Button OK" src="images/imgDC/luaimg11.png" width="66" height="21">
            </td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0001<br><small class="firstcolumnaleft">MB_OKCANCEL</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button OK" alt="Button OK" src="images/imgDC/luaimg11.png" width="66" height="21">
              <img class="largeimage" title="Button CANCEL" alt="Button CANCEL" src="images/imgDC/luaimg12.png" width="66" height="21">
            </td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0002<br><small class="firstcolumnaleft">MB_ABORTRETRYIGNORE</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button ABORT" alt="Button ABORT" src="images/imgDC/luaimg15.png" width="66" height="21">
              <img class="largeimage" title="Button RETRY" alt="Button RETRY" src="images/imgDC/luaimg14.png" width="66" height="21">
              <img class="largeimage" title="Button IGNORE" alt="Button IGNORE" src="images/imgDC/luaimg13.png" width="66" height="21">
            </td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0003<br><small class="firstcolumnaleft">MB_YESNOCANCEL</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button YES" alt="Button YES" src="images/imgDC/luaimg16.png" width="66" height="21">
              <img class="largeimage" title="Button NO" alt="Button NO" src="images/imgDC/luaimg17.png" width="66" height="21">
              <img class="largeimage" title="Button CANCEL" alt="Button CANCEL" src="images/imgDC/luaimg12.png" width="66" height="21">
            </td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0004<br><small class="firstcolumnaleft">MB_YESNO</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button YES" alt="Button YES" src="images/imgDC/luaimg16.png" width="66" height="21">
              <img class="largeimage" title="Button NO" alt="Button NO" src="images/imgDC/luaimg17.png" width="66" height="21">
            </td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0005<br><small class="firstcolumnaleft">MB_RETRYCANCEL</small></div></td>
            <td class="hintcell">
              <img class="largeimage" title="Button RETRY" alt="Button RETRY" src="images/imgDC/luaimg14.png" width="66" height="21">
              <img class="largeimage" title="Button CANCEL" alt="Button CANCEL" src="images/imgDC/luaimg12.png" width="66" height="21">
            </td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="dlgstyle">3.4.2. Style of box of Dialogs.MessageBox</a></h2>
        <p>The style of the box displayed by <code>Dialogs.MessageBox</code> function are controlled by a OR'ed value with one of the following:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Constant of ButFlags regarding the icon and style of Dialogs.MessageBox</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Constant value</th><th class="categorydesccolumn">Style of window</th></tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0040<br><small class="firstcolumnaleft">MB_ICONINFORMATION</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Icon INFORMATION" alt="Icon INFORMATION" src="images/imgDC/luaimg8.png" width="32" height="32"> Informative window</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0030<br><small class="firstcolumnaleft">MB_ICONWARNING</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Icon WARNING" alt="Icon WARNING" src="images/imgDC/luaimg9.png" width="32" height="32"> Warning window</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0020<br><small class="firstcolumnaleft">MB_ICONQUESTION</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Icon QUESTION" alt="Icon QUESTION" src="images/imgDC/luaimg7.png" width="32" height="32"> Confirmation window</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0010<br><small class="firstcolumnaleft">MB_ICONERROR</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Icon ERROR" alt="Icon ERROR" src="images/imgDC/luaimg10.png" width="32" height="32"> Error window</td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="dlgdefbut">3.4.3. Default active button of Dialogs.MessageBox</a></h2>
        <p>The default active button of the box displayed by <code>Dialogs.MessageBox</code> function are controlled by a OR'ed value with one of the following:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">Constant of ButFlags regarding the default button of Dialogs.MessageBox</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Constant value</th><th class="categorydesccolumn">Default button</th></tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0000<br><small class="firstcolumnaleft">MB_DEFBUTTON1</small></div></td>
            <td class="hintcell">Default will be the first one on left</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0100<br><small class="firstcolumnaleft">MB_DEFBUTTON2</small></div></td>
            <td class="hintcell">Default will be the second one from left</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0200<br><small class="firstcolumnaleft">MB_DEFBUTTON3</small></div></td>
            <td class="hintcell">Default will be the third one from left</td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="msgreturn">3.4.4. Returned value of Dialogs.MessageBox</a></h2>
        <p>The number returned by the <code>Dialogs.MessageBox</code> function represent the button user has pressed according to the following:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">ButPressed value returned based on button pressed of Dialogs.MessageBox</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Constant value</th><th class="categorydesccolumn">Button pressed</th></tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0000<br><small class="firstcolumnaleft">mrNone</small></div></td>
            <td class="hintcell">No button pressed</td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0001<br><small class="firstcolumnaleft">mrOK</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result OK" alt="Result OK" src="images/imgDC/luaimg11.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0002<br><small class="firstcolumnaleft">mrCancel</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result CANCEL" alt="Result CANCEL" src="images/imgDC/luaimg12.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0003<br><small class="firstcolumnaleft">mrAbort</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result ABORT" alt="Result ABORT" src="images/imgDC/luaimg15.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0004<br><small class="firstcolumnaleft">mrRetry</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result RETRY" alt="Result RETRY" src="images/imgDC/luaimg14.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0005<br><small class="firstcolumnaleft">mrIgnore</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result IGNORE" alt="Result IGNORE" src="images/imgDC/luaimg13.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0006<br><small class="firstcolumnaleft">mrYes</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result YES" alt="Result YES" src="images/imgDC/luaimg16.png" width="66" height="21"></td>
          </tr>
          <tr>
            <td class="varcell"><div class="firstcolumnaleft">0x0007<br><small class="firstcolumnaleft">mrNo</small></div></td>
            <td class="hintcell"><img class="largeimage" title="Result NO" alt="Result NO" src="images/imgDC/luaimg17.png" width="66" height="21"></td>
          </tr>
        </table>
        <p>Note: If we press the "x" in top right or press <kbd>Esc</kbd> to close the window, then the value of the button "Cancel" is will returned.</p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="mesgboxsample">3.4.5. Example of usage of the Dialogs.MessageBox</a></h2>
        <p>Here is a little script using <code>Dialogs.MessageBox</code> and the resulting window that will be displayed:</p>
        <pre>
<span class="luacmt">-- Buttons displayed</span>
MB_OK <span class="luasbl">=</span> <span class="luanum">0x0000</span>
MB_OKCANCEL <span class="luasbl">=</span> <span class="luanum">0x0001</span>
MB_ABORTRETRYIGNORE <span class="luasbl">=</span> <span class="luanum">0x0002</span>
MB_YESNOCANCEL <span class="luasbl">=</span> <span class="luanum">0x0003</span>
MB_YESNO <span class="luasbl">=</span> <span class="luanum">0x0004</span>
MB_RETRYCANCEL <span class="luasbl">=</span> <span class="luanum">0x0005</span>

<span class="luacmt">-- Box style</span>
MB_ICONINFORMATION <span class="luasbl">=</span> <span class="luanum">0x0040</span>
MB_ICONWARNING <span class="luasbl">=</span> <span class="luanum">0x0030</span>
MB_ICONQUESTION <span class="luasbl">=</span> <span class="luanum">0x0020</span>
MB_ICONERROR <span class="luasbl">=</span> <span class="luanum">0x0010</span>

<span class="luacmt">-- Default button</span>
MB_DEFBUTTON1 <span class="luasbl">=</span> <span class="luanum">0x0000</span>
MB_DEFBUTTON2 <span class="luasbl">=</span> <span class="luanum">0x0100</span>
MB_DEFBUTTON3 <span class="luasbl">=</span> <span class="luanum">0x0200</span>

<span class="luacmt">-- Returned button pressed</span>
mrNone <span class="luasbl">=</span> <span class="luanum">0x0000</span>
mrOK <span class="luasbl">=</span> <span class="luanum">0x0001</span>
mrCancel <span class="luasbl">=</span> <span class="luanum">0x0002</span>
mrAbort <span class="luasbl">=</span> <span class="luanum">0x0003</span>
mrRetry <span class="luasbl">=</span> <span class="luanum">0x0004</span>
mrIgnore <span class="luasbl">=</span> <span class="luanum">0x0005</span>
mrYes <span class="luasbl">=</span> <span class="luanum">0x0006</span>
mrNo <span class="luasbl">=</span> <span class="luanum">0x0007</span>

ButFlags <span class="luasbl">=</span> MB_YESNO <span class="luasbl">+</span> MB_ICONQUESTION <span class="luasbl">+</span> MB_DEFBUTTON2
ButPressed <span class="luasbl">=</span> <span class="mark">Dialogs.MessageBox</span><span class="luasbl">(</span><span class="luastr">"Do you want to quit?"</span><span class="luasbl">,</span> <span class="luastr">"Question"</span><span class="luasbl">,</span> ButFlags<span class="luasbl">)</span>

<span class="luakyw">if</span> ButPressed <span class="luasbl">==</span> mrYes <span class="luakyw">then</span>
  DC<span class="luasbl">.</span>ExecuteCommand<span class="luasbl">(</span><span class="luastr">"cm_Exit"</span><span class="luasbl">)</span>
<span class="luakyw">end</span></pre>
        <p class="figure"><img class="largeimage" title="Example of usage of the Dialogs.MessageBox" alt="Example of usage of the Dialogs.MessageBox" src="images/imgDC/luaimg6.png" width="362" height="120"></p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="querysample">3.4.6. Example of usage of the Dialogs.InputQuery</a></h2>
        <p>Here is a little script using <code>Dialogs.InputQuery</code> and the resulting window that will be displayed:</p>
        <pre>
bAck<span class="luasbl">,</span> sAnswer <span class="luasbl">=</span> <span class="mark">Dialogs.InputQuery</span><span class="luasbl">(</span><span class="luastr">"Identification"</span><span class="luasbl">,</span> <span class="luastr">"Enter your name:"</span><span class="luasbl">,</span> false<span class="luasbl">,</span> <span class="luastr">"John"</span><span class="luasbl">)</span>

<span class="luakyw">if</span> bAck <span class="luasbl">==</span> true then
  Dialogs<span class="luasbl">.</span>MessageBox<span class="luasbl">(</span><span class="luastr">"Hello "</span> <span class="luasbl">..</span> sAnswer .. <span class="luastr">"!"</span><span class="luasbl">,</span> <span class="luastr">"Welcome!"</span><span class="luasbl">,</span> <span class="luanum">0x0040</span><span class="luasbl">)</span>
<span class="luakyw">end</span></pre>
        <p class="figure"><img class="largeimage" title="Example of usage of the Dialogs.InputQuery" alt="Example of usage of the Dialogs.InputQuery" src="images/imgDC/luaimg5.png" width="364" height="112"></p>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="libraryutf8">3.5. UTF-8 library</a></h2>
        <p>This library provides basic support for UTF-8 encoding.</p>
        <p>It provides all its functions inside the table <code>LazUtf8</code>.</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">UTF-8 library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.Pos</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.Pos(SearchText, SourceText, Offset)</p>
              <p>Search for substring in a string, starting at a certain position. The search is case sensitive.</p>
              <p>Returns the position of the first occurrence of the substring <var>SearchText</var> in the string <var>SourceText</var>, starting the search at position <var>Offset</var> (default 1).</p>
              <p>If <var>SearchText</var> does not occur in <var>SourceText</var> after the given <var>Offset</var>, zero is returned.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.Copy</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.Copy(Source, Index, Count)</p>
              <p>Copy part of a string.</p>
              <p>Copy returns a string which is a copy if the <var>Count</var> characters in <var>Source</var>, starting at position <var>Index</var>.</p>
              <p>If <var>Count</var> is larger than the length of the string <var>Source</var>, the result is truncated. If <var>Index</var> is larger than the length of the string <var>Source</var>, then an empty string is returned.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.Length</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.Length(String)</p>
              <p>Returns the number of UTF-8 characters in the string.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.UpperCase</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.UpperCase(String)</p>
              <p>Receives a string and returns a copy of this string with all lowercase letters changed to uppercase.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.LowerCase</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.LowerCase(String)</p>
              <p>Receives a string and returns a copy of this string with all uppercase letters changed to lowercase.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">LazUtf8.ConvertEncoding</div></td>
            <td class="hintcell">
              <p class="definition">Result = LazUtf8.ConvertEncoding(String, FromEnc, ToEnc)</p>
              <p>Convert <var>String</var> encoding from <var>FromEnc</var> to <var>ToEnc</var>.</p>
              <p>List of supported encoding values:</p>
              <ul>
                <li>Default system encoding (depends on user locale): "default".</li>
                <li>Default ANSI (Windows) encoding (depends on user locale): "ansi".</li>
                <li>Default OEM (DOS) encoding (depends on user locale): "oem".</li>
                <li>Unicode: "utf8", "utf8bom", "ucs2le", "ucs2be".</li>
                <li>ANSI (Windows): "cp1250", "cp1251", "cp1252", "cp1253", "cp1254", "cp1255", "cp1256", "cp1257", "cp1258".</li>
                <li>OEM (DOS): "cp437", "cp850", "cp852", "cp866", "cp874", "cp932", "cp936", "cp949", "cp950".</li>
                <li>ISO 8859: "iso88591", "iso88592", "iso885915".</li>
                <li>Other: "macintosh", "koi8".</li>
              </ul>
              The meaning of special encodings (examples).
              <br><br>
              In the Windows with Russian locale:
              <ul>
              <li>"default" - cp1251</li>
              <li>"ansi" - cp1251</li>
              <li>"oem" - cp866</li>
              </ul>
              In the Linux with Russian locale:
              <ul>
              <li>"default" - utf8</li>
              <li>"ansi" - cp1251</li>
              <li>"oem" - cp866</li>
              </ul>
            </td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
      </div>

      <div>
        <h2><a name="libraryos">3.6. OS library</a></h2>
        <p>This library contains functions related with the operating system where Double Commander is running.</p>
        <p>Here is the list of available functions in this library:</p>
        <table>
          <tr class="rowcategorytitle"><th colspan="2">OS library</th></tr>
          <tr class="rowsubtitle"><th class="categorynamecolumn">Function name</th><th class="categorydesccolumn">Description</th></tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">os.execute</div></td>
            <td class="hintcell">
              <p class="definition">ResultCode = os.execute(Command)</p>
              <p>Will execute <var>Command</var> as it would be typed on the command-line and return the result code of the operation.</p>
              <p>The <var>Command</var> could either be:</p>
              <ul>
                <li>A terminal commmand like <code>os.execute("dir &gt; all.txt")</code></li>
                <li>An executable like <code>os.execute("C:\\Windows\\System32\\calc.exe")</code></li>
                <li>An executable with parameters:<br><code>os.execute("C:\\Utils\\fsum.exe -md5 test.bin &gt; md5.txt")</code></li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">os.tmpname</div></td>
            <td class="hintcell">
              <p class="definition">TempFileName = os.tmpname()</p>
              <p>Will return a filename to use as a temporary filename.</p>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">os.remove</div></td>
            <td class="hintcell">
              <p class="definition">bResult, ErrorStr, ErrorNum = os.remove(FileName)</p>
              <p>Will delete the file or the directory with the name <var>FileName</var>.</p>
              <p>If it works, function returns <code>true</code>.</p>
              <p>If it fails, function returns three things:</p>
              <ol>
                <li><code>nil</code> to indicate it failed</li>
                <li><var>ErrorStr</var> for the error message description</li>
                <li><var>ErrorNum</var> for the error code number</li>
              </ol>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">os.rename</div></td>
            <td class="hintcell">
              <p class="definition">bResult, ErrorStr, ErrorNum = os.rename(OldName, NewName)</p>
              <p>Will rename the file <var>OldName</var> with the new name <var>NewName</var>.</p>
              <p>If it works, function returns <code>true</code>.</p>
              <p>If it fails, function returns three things:</p>
              <ol>
                <li><code>nil</code> to indicate it failed</li>
                <li><var>ErrorStr</var> for the error message description</li>
                <li><var>ErrorNum</var> for the error code number</li>
              </ol>
            </td>
          </tr>
          <tr>
            <td class="cmdcell"><div class="firstcolumnaleft">os.getenv</div></td>
            <td class="hintcell">
              <p class="definition">Value = os.getenv(VariableName)</p>
              <p>Will return the <var>Value</var> of the variable <var>VariableName</var> passed in parameter.<br>If no variable of that name exists, it will return <code>nil</code>.</p></td>
          </tr>
        </table>
        <p class="navback"><a href="#topofpage">(back to top)</a></p>
        <br>
      </div>
    </div>
    <div class="footer"><div class="nav"><a title="Index" href="index.html">Index</a> | <a title="Previous page" href="regexp.html">Previous</a> | <a title="Next page" href="commandline.html">Next</a></div></div>
    <div class="checker">
      <a href="https://validator.w3.org/check?uri=referer" target="_blank"><img src="https://www.w3.org/Icons/valid-html40" alt="Valid HTML 4.0 Transitional" height="31" width="88"></a>
      <a href="https://jigsaw.w3.org/css-validator/check/referer" target="_blank"><img style="border:0;width:88px;height:31px" src="https://jigsaw.w3.org/css-validator/images/vcss" alt="CSS Valid!"></a>
    </div>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
  </body>
</html>
